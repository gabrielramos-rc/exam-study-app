# Task 1.1: Project Setup

## Context

This is the first task of Phase 1 (Project Foundation) for the Exam Study App. The app is a self-hosted Next.js 16 web application for studying certification exam questions with spaced repetition (SM-2 algorithm) and analytics. It's a single-user app designed to run in Docker with PostgreSQL. This task sets up the base Next.js project with TypeScript configuration and path aliases.

## Objective

Create a new Next.js 16 project with TypeScript, Tailwind CSS, ESLint, App Router, and src directory structure, then configure strict TypeScript settings, path aliases, and create the environment template file.

## Instructions

### Step 1: Create Next.js Project

Run the following command to create the project (if not already created):

```bash
npx create-next-app@latest exam-study-app --typescript --tailwind --eslint --app --src-dir
```

When prompted, select:
- Would you like to use TypeScript? **Yes**
- Would you like to use ESLint? **Yes**
- Would you like to use Tailwind CSS? **Yes**
- Would you like your code inside a `src/` directory? **Yes**
- Would you like to use App Router? **Yes**
- Would you like to use Turbopack for `next dev`? **Yes** (recommended for Next.js 16)
- Would you like to customize the import alias? **No** (we'll configure manually)

### Step 2: Configure tsconfig.json

Replace the contents of `tsconfig.json` with the following configuration that enables strict mode and sets up path aliases:

```json
{
  "compilerOptions": {
    "target": "ES2022",
    "lib": ["dom", "dom.iterable", "ES2022"],
    "allowJs": true,
    "skipLibCheck": true,
    "strict": true,
    "strictNullChecks": true,
    "strictFunctionTypes": true,
    "strictBindCallApply": true,
    "strictPropertyInitialization": true,
    "noImplicitAny": true,
    "noImplicitThis": true,
    "noUnusedLocals": true,
    "noUnusedParameters": true,
    "noImplicitReturns": true,
    "noFallthroughCasesInSwitch": true,
    "noUncheckedIndexedAccess": true,
    "forceConsistentCasingInFileNames": true,
    "esModuleInterop": true,
    "module": "esnext",
    "moduleResolution": "bundler",
    "resolveJsonModule": true,
    "isolatedModules": true,
    "jsx": "preserve",
    "incremental": true,
    "plugins": [
      {
        "name": "next"
      }
    ],
    "paths": {
      "@/*": ["./src/*"],
      "@/components/*": ["./src/components/*"],
      "@/lib/*": ["./src/lib/*"],
      "@/hooks/*": ["./src/hooks/*"],
      "@/stores/*": ["./src/stores/*"],
      "@/types/*": ["./src/types/*"]
    }
  },
  "include": ["next-env.d.ts", "**/*.ts", "**/*.tsx", ".next/types/**/*.ts"],
  "exclude": ["node_modules"]
}
```

### Step 3: Create Project Directory Structure

Create the following directories to match the project architecture:

```bash
mkdir -p src/components/ui
mkdir -p src/components/question
mkdir -p src/components/admin
mkdir -p src/components/analytics
mkdir -p src/components/layout
mkdir -p src/lib/parsers
mkdir -p src/hooks
mkdir -p src/stores
mkdir -p src/types
```

### Step 4: Create Types Index File

Create `src/types/index.ts` with the base TypeScript interfaces:

```typescript
// src/types/index.ts

/**
 * Question data stored as JSONB in the database
 */
export interface QuestionData {
  // Core content
  text: string;
  options: Record<string, string>;
  correct: string[];

  // Explanation
  explanation: string;
  whyWrong?: Record<string, string>;

  // Metadata
  section?: string;
  sectionId?: string;
  tags?: string[];
  confidence?: 'high' | 'medium' | 'low';

  // Media
  imageUrl?: string;

  // Source
  sourceUrl?: string;
}

/**
 * Progress data stored as JSONB for export/import
 */
export interface ProgressData {
  version: string;
  exportedAt: string;
  examId: string;

  answers: {
    questionNumber: number;
    selected: string[];
    correct: boolean;
    timeSpentMs: number;
    answeredAt: string;
  }[];

  srsCards: {
    questionNumber: number;
    easeFactor: number;
    intervalDays: number;
    repetitions: number;
    nextReview: string;
    lastGrade: number;
  }[];

  bookmarks: {
    questionNumber: number;
    createdAt: string;
  }[];
}

/**
 * SM-2 algorithm input parameters
 */
export interface SM2Input {
  grade: number; // 0-5
  repetitions: number;
  easeFactor: number;
  intervalDays: number;
}

/**
 * SM-2 algorithm output
 */
export interface SM2Output {
  repetitions: number;
  easeFactor: number;
  intervalDays: number;
  nextReview: Date;
}
```

### Step 5: Create Environment Template

Create `.env.example` at the project root:

```bash
# Database
DATABASE_URL=postgresql://study:study@localhost:5432/study

# App
NODE_ENV=development
PORT=3000
UPLOAD_MAX_SIZE=52428800
```

### Step 6: Create .env File for Development

Copy the example to create a local .env file:

```bash
cp .env.example .env
```

### Step 7: Create Utility File

Create `src/lib/utils.ts` with basic utility functions (required for shadcn/ui later):

```typescript
// src/lib/utils.ts

import { type ClassValue, clsx } from "clsx";
import { twMerge } from "tailwind-merge";

export function cn(...inputs: ClassValue[]) {
  return twMerge(clsx(inputs));
}
```

Install the required dependencies for the utility:

```bash
npm install clsx tailwind-merge
```

### Step 8: Update .gitignore

Ensure `.gitignore` includes the necessary entries:

```gitignore
# Dependencies
/node_modules
/.pnp
.pnp.js
.yarn/install-state.gz

# Testing
/coverage

# Next.js
/.next/
/out/

# Production
/build

# Misc
.DS_Store
*.pem

# Debug
npm-debug.log*
yarn-debug.log*
yarn-error.log*

# Local env files
.env
.env*.local

# Vercel
.vercel

# TypeScript
*.tsbuildinfo
next-env.d.ts

# Prisma
/prisma/migrations/**/migration_lock.toml

# Uploads (runtime)
/uploads
/public/images

# IDE
.idea/
.vscode/
```

### Step 9: Verify Setup

Run the development server to verify everything works:

```bash
npm run dev
```

Open http://localhost:3000 in your browser - you should see the default Next.js welcome page.

## Acceptance Criteria

Before marking this task complete, verify:

1. `tsconfig.json` has `"strict": true` and all strict sub-options enabled
2. Path aliases work: `@/*`, `@/components/*`, `@/lib/*`, `@/hooks/*`, `@/stores/*`, `@/types/*`
3. Directory structure exists:
   - `src/components/ui/`
   - `src/components/question/`
   - `src/components/admin/`
   - `src/components/analytics/`
   - `src/components/layout/`
   - `src/lib/parsers/`
   - `src/hooks/`
   - `src/stores/`
   - `src/types/`
4. `src/types/index.ts` exists with `QuestionData`, `ProgressData`, `SM2Input`, `SM2Output` interfaces
5. `.env.example` exists with `DATABASE_URL`, `NODE_ENV`, `PORT`, `UPLOAD_MAX_SIZE`
6. `.env` file exists (copy of `.env.example`)
7. `src/lib/utils.ts` exists with `cn()` function
8. `npm run dev` starts successfully without TypeScript errors
9. http://localhost:3000 loads the Next.js welcome page

## Notes

- **OUT OF SCOPE**: Do not install shadcn/ui yet - that's Task 1.2
- **OUT OF SCOPE**: Do not set up Prisma or the database - that's Task 1.3
- **OUT OF SCOPE**: Do not create Docker files - that's Task 1.4
- **OUT OF SCOPE**: Do not create layout components or navigation - that's Task 1.5
- The `clsx` and `tailwind-merge` packages are installed now because they're required by the `cn()` utility that shadcn/ui expects
- If the project was already created with different settings, adjust the tsconfig.json and directory structure to match the specifications above
